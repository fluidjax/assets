syntax="proto3";

package protobuffer;
//import "github.com/mwitkow/go-proto-validators/validator.proto";



message Signature {
    bytes Signature         = 1;
    repeated bytes Signers  = 2;
    Asset Asset             = 3;
}

message Asset {
	AssetType Type  = 1;            //Type of Asset
	bytes ID        = 2;                       //unique ID of asset
	bytes Owner     = 3;                    //IDDoc of owner            
    oneof AssetDefinition {          //Definiton of the asset
        Wallet Wallet = 4;
        TrusteeGroup TrusteeGroup = 5;
        IDDoc Iddoc = 6;
    }
	repeated Transfer Transferlist    = 7;    //List of Transfer rules for subsequent updates
}

enum AssetType {
	wallet      = 0;
	trustee     = 1;
	iddoc       = 2;
}                              
enum TransferType {
    unspecified         = 0;
    settlePush          = 1;
    settlePull          = 2;
    transferPush        = 3;
    tranferPull         = 4;
    swap                = 5;
    load                = 6;
}

message Transfer {                  //Defined for each Transfer type an expression that must return true to allow transfer to be performed
    TransferType Type               = 1;	
    string Expression               = 2;              //Boolean expression eg. (SigTrustee1 + SigTrustee2 + SigTrustee3) >=2 & Owner   
    map<string, bytes> Participants = 3;
}

//Asset Definitons
message Wallet {
    string Description      = 1;
    bytes principal         = 2;
	bytes creditor          = 3;
	bytes initiator         = 4;
	bytes address           = 5;
	bytes counterparty      = 6;
}


message TrusteeGroup {
    repeated bytes TrusteeID    = 1; //List of Trustee DocIDs
    int64 threshold             = 2; //Threshold required
}

message IDDoc {
    string AuthenticationReference = 1;
    bytes BeneficiaryECPublicKey   = 2;
    bytes SikePublicKey            = 3;
    bytes BLSPublicKey             = 4;
    int64 Timestamp                = 5;
}